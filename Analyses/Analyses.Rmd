---
title: "Analyses"
author: "Vera Weisbecker and Cruise Speck"
date: "5 December 2018"
output: html_document
---



## load required packages and processed data



```{r }
library(ape)
library(geiger)
library(phytools)
library(caper)
library(car)
library(multcomp)
library(geomorph)
library(lmSupport)
library(ggplot2)
library(nlme)
library(dplyr)
library(RColorBrewer)

#the "utilities" file contains functions so this analysis page isn't too cluttered
source("../Analyses/Utilities.r")
load(file = "../Data/Processed_Data_for_Pgls.rda")
data_raw=read.csv("../Data/raw_data.csv", header=TRUE)

```


#First, some basic data on the quality of the raw dataset

```{r}

marsraw=data_raw[1:146,]
rownames(marsraw)=marsraw$Species


rodraw=data_raw[147:210,]
rownames(rodraw)=rodraw$Species

#How many percent of the dataset entries are there for each of the entry categories?

DataQuality=as.data.frame(rbind(sapply(marsraw[,2:28], function(x) sum((!is.na(x))/nrow(marsraw))*100),sapply(rodraw[,2:28], function(x) sum((!is.na(x)))/nrow(rodraw))*100))
rownames(DataQuality)=c("Marsupials", "Rodents")

```

#Phylogenetic signal of tail length, head and body length, and body weight

```{r}
# There's something wrong with the order of tips and the dataset; reorder using Emma's trick in the brain code
marsTree$tip.label
mars$Species


phylosig(marsTree, mars$Tl_mm, method="K", test=FALSE, nsim=1000)
phylosig(marsTree, mars$Bl_mm, method="K", test=FALSE, nsim=1000)
phylosig(marsTree, mars$Wt_g, method="K", test=FALSE, nsim=1000)

phylosig(rodTree, rod$Tl_mm, method="K", test=FALSE, nsim=1000)
phylosig(rodTree, rod$Bl_mm, method="K", test=FALSE, nsim=1000)
phylosig(rodTree, rod$Wt_g, method="K", test=FALSE, nsim=1000)

```


# Testing the hypothesis that within-species body weight maxima are greater relative to body weight minima(i.e. the range is relatively wider), compared to the same ratio in within-species body or tail lengths) - for those species where ranges are available, body mass ranges are substantially greater

```{r}
#Marsupials

  ##return the min/max values to their un-logged form
  ratio_Tl=c(10^(marsFull$Tl_max)/10^(marsFull$Tl_min))
  ratio_Bl=c(10^(marsFull$Bl_max)/10^(marsFull$Bl_min))
  ratio_Wt=c(10^(marsFull$Wt_max)/10^(marsFull$Wt_min))
  
  ##Visualizing means of the ratios 
  boxplot(ratio_Tl, ratio_Bl,ratio_Wt)
  
  ratiosMars=c(ratio_Tl, ratio_Bl, ratio_Wt)
  
  ##The VarDist.test code is in utilities. It runs a Kruskal-Wallis test and then a pairwise wilcoxon rank sum test on the ratios
  MinMaxtest(ratios,3)
  
  boxplot(ratio_Tl, ratio_Bl,ratio_Wt)
  
  ##This is not mainly because of the extreme ranges in bandicoots!
  
  ratio_Tl_Band<-ratio_Tl[ - (grep("Macrotis_leucura", marsFull$Species):grep("Echymipera_rufescens", mars$Species))]
  ratio_Bl_Band<-ratio_Bl[ - (grep("Macrotis_leucura", marsFull$Species):grep("Echymipera_rufescens", mars$Species))]
  ratio_Wt_Band<-ratio_Wt[ - (grep("Macrotis_leucura", marsFull$Species):grep("Echymipera_rufescens", mars$Species))]
  
  ratiosBand=c(ratio_Tl_Band, ratio_Bl_Band, ratio_Wt_Band)
  MinMaxtest(ratiosBand,3)
  
  par(mfrow=c(1,2))
  boxplot(ratio_Tl, ratio_Bl,ratio_Wt, xlab="ratios with bandicoots")
  boxplot(ratio_Tl_Band, ratio_Bl_Band,ratio_Wt_Band, xlab="ratios without bandicoots")

#Rodents

  ##return the min/max values to their un-logged form
  ratio_Tl=c(10^(rodFull$Tl_max)/10^(rodFull$Tl_min))
  ratio_Bl=c(10^(rodFull$Bl_max)/10^(rodFull$Bl_min))
  ratio_Wt=c(10^(rodFull$Wt_max)/10^(rodFull$Wt_min))
  
  ##Visualizing means of the ratios 
  boxplot(ratio_Tl, ratio_Bl,ratio_Wt)
  
  ratiosRod=c(ratio_Tl, ratio_Bl, ratio_Wt)
  
  ##The VarDist.test code is in utilities. It runs a Kruskal-Wallis test and then a pairwise wilcoxon test on the ratios
  MinMaxtest(ratiosRod,3)
  
  boxplot(ratio_Tl, ratio_Bl,ratio_Wt)
  
  ##Is there a difference between Rattus and the old endemics.
  
  ratio_Tl_Rat<-ratio_Tl[ - (grep("Rattus_leucopus", rodFull$Species):grep("Rattus_fuscipes", rodFull$Species))]
  ratio_Bl_Rat<-ratio_Bl[ - (grep("Rattus_leucopus", rodFull$Species):grep("Rattus_fuscipes", rodFull$Species))]
  ratio_Wt_Rat<-ratio_Wt[ - (grep("Rattus_leucopus", rodFull$Species):grep("Rattus_fuscipes", rodFull$Species))]
  
  ratiosRat=c(ratio_Tl_Band, ratio_Bl_Band, ratio_Wt_Band)
  MinMaxtest(ratiosRat,3)
  
  par(mfrow=c(1,2))
  boxplot(ratio_Tl, ratio_Bl,ratio_Wt, xlab="ratios with Rattus")
  boxplot(ratio_Tl_Rat, ratio_Bl_Rat,ratio_Wt_Rat, xlab="ratios without Rattus")



```

#is there a difference in tail/body length relationships between the sexes or if we use maximum tail length? This is only possible in a non phylogenetic context

```{r}
#Marsupials:

  ##Re-arrange datasets to put males, femals and averages under each other, turning into a data frame for column names
  
  Males<-cbind(marsFull$Tl_Av_M,marsFull$Bl_Av_M,marsFull$Wt_Av_M, rep(1,length(marsFull$Tl_Av_M)))
  Females<-cbind(marsFull$Tl_Av_F,marsFull$Bl_Av_F,marsFull$Wt_Av_F, rep(2,length(marsFull$Tl_Av_F)))
  Averages<-cbind(marsFull$Tl_mm, marsFull$Bl_mm,marsFull$Wt_g, rep(3,length(marsFull$Bl_mm)))
  
  MarsCombine=rbind(Males, Females,Averages)
  MarsCombine=as.data.frame(MarsCombine)
  colnames(MarsCombine) <-c("Tl","Bl","Wt","Sex")
  MarsCombine$Sex<-as.factor(MarsCombine$Sex)

  
  ##Are there differences in slope of Tail length and body length or weight according to sex, or averages between sexes?
  
  ###check model residuals before proceeding; some low-leverage outliers
  plot(lm(MarsCombine$Tl~MarsCombine$Bl*MarsCombine$Sex))
  
  ### Do regression slopes differ between sexes?
  summary(aov (MarsCombine$Tl~MarsCombine$Bl*MarsCombine$Sex))
  
  ### No significant interactions, therefore dropping interactions to look for differences in intercept
  summary(aov (MarsCombine$Tl~MarsCombine$Bl+MarsCombine$Sex))
  
  ###check model residuals before proceeding
  plot(lm(MarsCombine$Tl~MarsCombine$Wt*MarsCombine$Sex))
  
  ### Do regression slopes differ between sexes?
  summary(aov (MarsCombine$Tl~MarsCombine$Wt*MarsCombine$Sex))
  
  ### No significant interactions, therefore dropping interactions to look for differences in intercept
  summary(aov (MarsCombine$Tl~MarsCombine$Wt+MarsCombine$Sex))
  
  

#Rodents:

  RodMales<-cbind(rodFull$Tl_Av_M,rodFull$Bl_Av_M,rodFull$Wt_Av_M, rep(1,length(rodFull$Tl_Av_M)))
  RodFemales<-cbind(rodFull$Tl_Av_F,rodFull$Bl_Av_F,rodFull$Wt_Av_F, rep(2,length(rodFull$Tl_Av_F)))
  RodAverages<-cbind(rodFull$Tl_mm, rodFull$Bl_mm,rodFull$Wt_g, rep(3,length(rodFull$Bl_mm)))
  
  RodCombine=rbind(RodMales, RodFemales,RodAverages)
  RodCombine=as.data.frame(RodCombine)
  colnames(RodCombine) <-c("Tl","Bl","Wt","Sex")
  RodCombine$Sex<-as.factor(RodCombine$Sex)
 
  
  ##Are there differences in slope of tail length and body lenght/weight according to locomotor use, sex, or averages between sexes?
    ###check for appropriate distribution of model residuals
    plot(lm(RodCombine$Tl~RodCombine$Bl*RodCombine$Sex))
 
    summary(aov(lm(RodCombine$Tl~RodCombine$Bl*RodCombine$Sex)))
  
   ###No interaction (i.e. slopes are the same), therefore dropping interaction
    summary(aov(lm(RodCombine$Tl~RodCombine$Bl+RodCombine$Sex)))
  
    ##Same with body weight
    plot(lm(RodCombine$Tl~RodCombine$Wt*RodCombine$Sex))
    summary(aov(lm(RodCombine$Tl~RodCombine$Wt*RodCombine$Sex)))
   ##No interaction (i.e. slopes are the same), therefore dropping interaction
    summary(aov(lm(RodCombine$Tl~RodCombine$Wt+RodCombine$Sex)))
  
  
  #########################note to self below, delete later
  
  
  
  #If significant interactions, use
  testInteractions(Sex_locomotion)
  #if not, re-run without interactions; if any intercept is significant, run something like the below
  TukeyHSD(MaleFemaleaov,which='Sex', data=Combine )
  
  #Are there differences in slope of Tail length and body WEIGHT according to locomotor use, sex, or averages between sexes?
  Sex_locomotion=summary(lm(Combine$Tl~Combine$Wt *Combine$Sex*Combine$Locomotor_use))
  Sex_locomotion=aov (Combine$Tl~Combine$Wt*Combine$Sex*Combine$Locomotor_use)
  
  #If significant interactions, use
  testInteractions(Sex_locomotion)
  #if not, re-run without interactions; if any intercept is significant, run something like the below
  TukeyHSD(MaleFemaleaov,which='Sex', data=Combine )


```

# How do tail lengths scale with body length and weight? 

```{r}

#Marsupials
    
      ##Tail vs. body length
      MarsTB=find.best.model(Tl_mm~Bl_mm,marsTree,mars);MarsTB$AIC_Weights
      #Checking appropriate distribution of model residuals      
      qqnorm (MarsTB$Models$Brownian)      
      MarsTB$Model_summaries$Brownian$tTable
      
      
      ##Tail vs body weight
      MarsTW=find.best.model(Tl_mm~Wt_g,marsTree,mars);MarsTW$AIC_Weights
      #Checking appropriate distribution of model residuals
      qqnorm (MarsTB$Models$Brownian)
      MarsTW$Model_summaries$Brownian$tTable
      
 ##rodents with Rattus
      
      ###Tail vs. body length
      rodTB=find.best.model(Tl_mm~Bl_mm,rodTree,rod);rodTB$AIC_Weights
      #Checking appropriate distribution of model residuals      
      qqnorm (rodTB$Models$Brownian)      
      rodTB$Model_summaries$Brownian$tTable
      
      
      ###Tail vs body weight
      rodTW=find.best.model(Tl_mm~Wt_g,rodTree,rod);rodTW$AIC_Weights
      #Checking appropriate distribution of model residuals
      qqnorm (rodTB$Models$Brownian)
      rodTW$Model_summaries$Brownian$tTable
      
  ##rodents without Rattus
      
      ###Tail vs. body length
      MurTB=find.best.model(Tl_mm~Bl_mm,murine_tree,murine_data);MurTB$AIC_Weights
      #Checking appropriate distribution of model residuals; excluding Rattus improves this     
      qqnorm (MurTB$Models$Brownian) 
      #but no change in scaling coefficient
      MurTB$Model_summaries$Brownian$tTable
      
      
      ###Tail vs body weight
      MurTW=find.best.model(Tl_mm~Wt_g,murine_tree,murine_data);MurTW$AIC_Weights
      #Checking appropriate distribution of model residuals
      qqnorm (MurTW$Models$Brownian_GrafScale)
      MurTW$Model_summaries$Brownian$tTable
      
```

# Does the significance level drop if body weight and body length are both part of the model?

```{r}
      
#Marsupials

      MarsTBW=find.best.model(Tl_mm~Bl_mm*Wt_g,marsTree,mars);MarsTW$AIC_Weights
      #Checking appropriate distribution of model residuals
      qqnorm (MarsTBW$Models$Brownian)
      anova(MarsTBW$Models$Brownian, type="marginal")
      
      ##dropping the interaction 
      MarsTBWNoInter=find.best.model(Tl_mm~Bl_mm+Wt_g,marsTree,mars);MarsTW$AIC_Weights
      #Checking appropriate distribution of model residuals
      qqnorm (MarsTBWNoInter$Models$Brownian)
      anova(MarsTBWNoInter$Models$Brownian, type="marginal")

#Rodents with Rattus
      
      rodTBW=find.best.model(Tl_mm~Bl_mm*Wt_g,rodTree,rod);rodTW$AIC_Weights
      #Checking appropriate distribution of model residuals
      qqnorm (rodTBW$Models$Brownian)
      anova(rodTBW$Models$Brownian)
      
      ###dropping the interaction 
      rodTBWNoInter=find.best.model(Tl_mm~Bl_mm+Wt_g,rodTree,rod);rodTW$AIC_Weights
      #Checking appropriate distribution of model residuals; this one is not ideal
      qqnorm (rodTBWNoInter$Models$Brownian_GrafScale)
      #significant but with small effect size
      anova(rodTBWNoInter$Models$Brownian_GrafScale, type="marginal")
 
#Rodents without Rattus
 
      MurTBW=find.best.model(Tl_mm~Bl_mm*Wt_g,murine_tree,murine_data);MurTW$AIC_Weights
      #Checking appropriate distribution of model residuals
      qqnorm (MurTBW$Models$Brownian_GrafScale)
      anova(MurTBW$Models$Brownian_GrafScale, type="marginal")
      
      ###dropping the interaction 
      MurTBWNoInter=find.best.model(Tl_mm~Bl_mm+Wt_g,murine_tree,murine_data);MurTW$AIC_Weights
      #Checking appropriate distribution of model residuals; this one is not ideal
      qqnorm (MurTBWNoInter$Models$Brownian_GrafScale)
      #significant but with small effect size; but higher level of significance without Rattus
      anova(MurTBWNoInter$Models$Brownian_GrafScale, type="marginal")

```

# Aside from the association between body length and tail length,does locomotor mode play a role?

```{r}

#Marsupials
    
  ##Tail vs body length
    TB=find.best.model(Tl_mm~Bl_mm*Locomotor_use,marsTree,mars);TB$AIC_Weights
    TB= (gls(Tl_mm~Bl_mm*Locomotor_use, correlation=corBrownian(1,phy=marsTree), data=mars))    

       
    #check if the residuals of the model are OK, this is using qqnorm.gls from the nlme package
    qqnorm (TB$Models$Brownian)
    
    ###look at the model summary of the most likely model, e.g. 
    TB$Model_summaries$corBrownian$tTable
      
    ###if the interactions are not significant (i.e. slopes are not sig. different), drop them    
    TB_no_inter=find.best.model(Tl_mm~Bl_mm+Locomotor_use,marsTree,mars);TB$AIC_Weights
    TB_no_inter$Model_summaries$corBrownian$tTable
    anova(TB_no_inter$Model_summaries$corBrownian, type="marginal")
   
     #or use phytools - not sure how to deal with the label warnings
    Locomotor_use=c(mars$Locomotor_use)
    names(Locomotor_use)<-names(mars$Species)
    phylANOVA(marsTree,Locomotor_use,mars$Tl_mm)
    
     ###using the smaller, m/f specific datasets note THIS NEEDS LARGE NUMBERS OF DATA SO DOES NOT ALWAYS DO INTERACTIONS
    TBF=find.best.model(Tl_Av_F ~Bl_Av_F+Locomotor_use,mf_marstree, mf_mars);TB$AIC_Weights
    anova(TBF$Model_summaries$corPagel, type="marginal")
    
    TBM=find.best.model(Tl_Av_M~Bl_Av_M+Locomotor_use,mf_marstree,mf_mars); TB$AIC_Weights
    anova(TBM$Model_summaries$corPagel, type="marginal")
    
  ##Tail vs body WEIGHT
    TW=find.best.model(Tl_mm~Wt_g*Locomotor_use,marsTree,mars);TW$AIC_Weights
    anova(TW$Model_summaries$corBrownian, type="marginal")  
    
    ###no interactions, therefore
    TW_no_inter=find.best.model(Tl_mm~Wt_g+Locomotor_use,marsTree,mars);TW$AIC_Weights
    anova(TW_no_inter$Model_summaries$corBrownian, type="marginal") 
    
    
    ###using the smaller, m/f specific datasets
    TWF=find.best.model(Tl_Av_F ~Wt_Av_F+Locomotor_use,mf_marstree, mf_mars);TW$AIC_Weights
    anova(TWF$Model_summaries$corBrownian, type="marginal") 
      
    TWM=find.best.model(Tl_Av_M~Wt_Av_M+Locomotor_use,mf_marstree,mf_mars);TW$AIC_Weights
    anova(TWF$Model_summaries$corBrownian, type="marginal") 
  
    
#Rodents
    
   #All rodents 
    
    ##Tail vs body LENGTH
      RodTB=find.best.model(Tl_mm~Bl_mm*Locomotor_use,rodTree,rod);RodTB$AIC_Weights
      #several similarly likely models but they yield similar levels of significance
      qqnorm (RodTB$Models$Pagel_GrafScale)
      anova(RodTB$Models$Pagel)
      
      ##No interactions (i.e. no differences in tail/Bl slope according to locomotion), so dropping interaction
      RodTBNoInter=find.best.model(Tl_mm~Bl_mm+Locomotor_use,rodTree,rod);RodTBNoInter$AIC_Weights
      #qqnorm (RodTBNoInter$Models$Pagel_GrafScale)
      anova(RodTBNoInter$Models$Pagel_GrafScale)
        
     
    ##Tail vs body WEIGHT
      RodTW=find.best.model(Tl_mm~Wt_g*Locomotor_use,rodTree,rod);RodTW$AIC_Weights
      qqnorm (RodTWNoInter$Models$Pagel_GrafScale)
      anova(RodTW$Models$Pagel_GrafScale) 
      
      ##No interactions (i.e. no differences in tail/Bl slope according to locomotion), so dropping interaction
      RodTWNoInter=find.best.model(Tl_mm~Wt_g*Locomotor_use,rodTree,rod);RodTWNoInter$AIC_Weights
      anova(RodTBNoInter$Models$Pagel_GrafScale)
  
  #All rodents 
    
    ##Tail vs body LENGTH
      RodTB=find.best.model(Tl_mm~Bl_mm*Locomotor_use,rodTree,rod);RodTB$AIC_Weights
      #several similarly likely models; technically the Pagel correlation structure without Grafen-scaled trees performs slightly better but the level of significance is the same in just Pagel and the original tree (which is also the more likely model in the no interaction model)
      anova(RodTB$Models$Pagel_GrafScale)
      
      ##No interactions (i.e. no differences in tail/Bl slope according to locomotion), so dropping interaction
      RodTBNoInter=find.best.model(Tl_mm~Bl_mm+Locomotor_use,rodTree,rod);RodTBNoInter$AIC_Weights
      anova(RodTBNoInter$Models$Pagel_GrafScale)
        
     
    ##Tail vs body WEIGHT
      RodTW=find.best.model(Tl_mm~Wt_g*Locomotor_use,rodTree,rod);RodTW$AIC_Weights
      anova(RodTW$Models$Pagel_GrafScale) 
      
      ##No interactions (i.e. no differences in tail/Bl slope according to locomotion), so dropping interaction
      RodTWNoInter=find.best.model(Tl_mm~Wt_g*Locomotor_use,rodTree,rod);RodTWNoInter$AIC_Weights
      anova(RodTBNoInter$Models$Pagel_GrafScale)   
      
   
```


#Plotting male, female and averages 

```{r}
  
#plot male-only, female-only, and averaged datasets together - Marsupials only 

par(mfrow=c(1,2))

plot(mars$Bl_Av_M,mars$Tl_Av_M, col="red", pch=19);points(mars$Bl_Av_F,mars$Tl_Av_F, col="blue", pch=19);points(mars$Bl_mm,mars$Tl_mm, col="green", pch=19);abline(lm(mars$Tl_Av_M~mars$Bl_Av_M), col="red");abline(lm(mars$Tl_Av_F~mars$Bl_Av_F), col="blue"); abline(lm(mars$Tl_mm~mars$Bl_mm), col="green")


plot(mars$Wt_Av_M,mars$Tl_Av_M, col="red", pch=19);points(mars$Wt_Av_F,mars$Tl_Av_F, col="blue", pch=19);points(mars$Wt_g,mars$Tl_mm, col="green", pch=19);abline(lm(mars$Tl_Av_M~mars$Wt_Av_M), col="red");abline(lm(mars$Tl_Av_F~mars$Wt_Av_F), col="blue"); abline(lm(mars$Tl_mm~mars$Wt_g), col="green")  


```

#Plotting according to tail use and phylogeny - body length

```{r}
#Marsupials
  
  ## initial setup: colours and margins
    colsOrderM=brewer.pal(n=length(levels(mars$Order)), name="Dark2")
    colsLoco=brewer.pal(n=length(levels(mars$Locomotor_use)), name="Dark2")
    colsOrderR=brewer.pal(n=length(levels(rodFull$Order)), name="Dark2")
    # Size of points
    cexes <- 0.8
    # this adjusts the titles of the double panel
    adjs <- -0.3
    # spaces between legend lines
    yInter <- 0.3
    #size of the box is determined by text width
    textwidth <- 0.5
    
    #4 panels, with margins of 2 lines
    par(mfrow=c(2,2), mar = c(4,4,4,4))
  
  plot(mars$Tl_mm~mars$Bl_mm, col=colsOrderM[mars$Order], pch=19, xlab="log Body length", ylab="log Tail length") ;legend("bottomright", c("Dasyuromorph" ,  "Diprotodontian", "Peramelemorph"), pch=19, col=colsOrderM, cex=cexes,y.intersp = yInter, text.width = textwidth ); #text(mars$Tl_mm~mars$Bl_mm, labels=mars$Species, cex=0.5)
  
  plot(mars$Tl_mm~mars$Bl_mm, col=colsLoco[mars$Locomotor_use], pch=19, xlab="log Body length", ylab="log Tail length" ); legend("bottomright",levels(mars$Locomotor_use) , pch=19, col=colsLoco, cex=cexes, y.intersp = yInter, text.width = textwidth)
  
  mtext("Marsupials", adj=adjs,side=3, line=2, cex=1)
  
  ##Rodents
  
  plot(rodFull$Tl_mm~rodFull$Bl_mm, col=colsOrderR[rodFull$Order], pch=19, xlab="log Body length", ylab="log Tail length" );legend("bottomright", c("Murine" ,  "Rattus"), pch=19, col=colsOrderR, cex=cexes,y.intersp = yInter, text.width = textwidth); #text(rodFull$Tl_mm~rodFull$Bl_mm, labels=rodFull$Species, cex=cexes)
  
  plot(rodFull$Tl_mm~rodFull$Bl_mm, col=colsLoco[rodFull$Locomotor_use], pch=19, xlab="log Body length", ylab="log Tail length" ); legend("bottomright",levels(rodFull$Locomotor_use) , pch=19, col=colsLoco, cex=cexes,  ncol=2, y.intersp = yInter, text.width = textwidth)
  
  mtext("Rodents", adj=adjs, line=2, cex = 1)

```


#Plotting according to tail use and phylogeny - body mass

```{r}

  ##Marsupials
  
  
    ## initial setup: colours and margins
    colsOrderM=brewer.pal(n=length(levels(mars$Order)), name="Dark2")
    colsLoco=brewer.pal(n=length(levels(mars$Locomotor_use)), name="Dark2")
    colsOrderR=brewer.pal(n=length(levels(rodFull$Order)), name="Dark2")
    cexes<-0.6
    adjs=-0.3
    x.intersp=1
    
    #4 panels, with margins of 2 lines
    par(mfrow=c(2,2), mar = c(4,4,4,4))
  
  plot(mars$Tl_mm~mars$Wt_g, col=colsOrderM[mars$Order], pch=19, xlab="log Body mass", ylab="log Tail length" );legend("bottomright", c("Dasyuromorph" ,  "Diprotodontian", "Peramelemorph"), pch=19, col=colsOrderM, cex=cexes); #text(mars$Tl_mm~mars$Wt_g, labels=mars$Species, cex=0.5)
  
  plot(mars$Tl_mm~mars$Wt_g, col=colsLoco[mars$Locomotor_use], pch=19, xlab="log Body mass", ylab="log Tail mass" ); legend("bottomright",levels(mars$Locomotor_use) , pch=19, col=colsLoco, cex=cexes)
  
  mtext("Marsupials", adj=adjs,side=3, line=2, cex=1)
  
  ##Rodents
  
  plot(rodFull$Tl_mm~rodFull$Wt_g, col=colsOrderR[rodFull$Order], pch=19, xlab="log Body mass", ylab="log Tail length" );legend("bottomright", c("Murine" ,  "Rattus"), pch=19, col=colsOrderR, cex=cexes); #text(rodFull$Tl_mm~rodFull$Wt_g, labels=rodFull$Species, cex=cexes)
  
  plot(rodFull$Tl_mm~rodFull$Wt_g, col=colsLoco[rodFull$Locomotor_use], pch=19, xlab="log Body mass", ylab="log Tail length" ); legend("bottomright",levels(rodFull$Locomotor_use) , pch=19, col=colsLoco, cex=cexes)
  
  mtext("Rodents", adj=adjs, line=2, cex = 1)

```
